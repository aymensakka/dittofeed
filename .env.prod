# Dittofeed Production Environment Configuration
# Generated for Enterprise Multitenancy Deployment
# Last Updated: January 30, 2025

# =============================================================================
# SECURITY CREDENTIALS (CHANGE THESE FOR PRODUCTION!)
# =============================================================================

# Database Password (REQUIRED)
POSTGRES_PASSWORD=your_secure_postgres_password_here

# JWT Secret for Authentication (REQUIRED - Generate with: openssl rand -base64 32)
JWT_SECRET=your_jwt_secret_32_chars_min_here

# Encryption Key for Secrets (REQUIRED - Generate with: openssl rand -base64 32)
ENCRYPTION_KEY=your_encryption_key_32_chars_here

# NextAuth Secret (REQUIRED - Generate with: openssl rand -base64 32)
NEXTAUTH_SECRET=your_nextauth_secret_here

# Grafana Admin Password (REQUIRED)
GRAFANA_PASSWORD=your_grafana_admin_password_here

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Primary Database Connection
DATABASE_URL=postgresql://dittofeed:${POSTGRES_PASSWORD}@postgres:5432/dittofeed

# Database Pool Settings (Optimized for Multitenancy)
DB_POOL_SIZE=20
DB_POOL_TIMEOUT=30000
DB_POOL_IDLE_TIMEOUT=600000
DB_POOL_MAX_LIFETIME=1800000

# =============================================================================
# REDIS CACHE CONFIGURATION
# =============================================================================

# Redis Connection
REDIS_URL=redis://redis:6379
REDIS_PASSWORD=your_redis_password_here

# Redis Pool Settings
REDIS_POOL_SIZE=10
REDIS_POOL_MIN=2
REDIS_POOL_MAX=20

# =============================================================================
# ENTERPRISE MULTITENANCY SETTINGS
# =============================================================================

# Row-Level Security (RLS) Configuration
ENABLE_RLS_ENFORCEMENT=true
RLS_BYPASS_ROLE=superadmin

# Tenant Cache Configuration
TENANT_CACHE_TTL=300
TENANT_CACHE_PREFIX=dt:tenant
WORKSPACE_CACHE_TTL=600

# Resource Quota Defaults
DEFAULT_MAX_USERS=1000
DEFAULT_MAX_SEGMENTS=50
DEFAULT_MAX_JOURNEYS=20
DEFAULT_MAX_BROADCASTS=100
DEFAULT_MAX_COMPUTED_PROPERTIES=100
DEFAULT_MAX_AUDIENCES=50
DEFAULT_MAX_EMAIL_TEMPLATES=100
DEFAULT_MAX_SUBSCRIPTION_GROUPS=10

# =============================================================================
# SECURITY & AUDIT CONFIGURATION
# =============================================================================

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=info
AUDIT_LOG_RETENTION_DAYS=90
AUDIT_LOG_EXPORT_BUCKET=s3://your-audit-logs-bucket

# Security Thresholds
MAX_LOGIN_ATTEMPTS=5
LOGIN_LOCKOUT_MINUTES=15
SUSPICIOUS_ACTIVITY_THRESHOLD=10
RATE_LIMIT_REQUESTS_PER_MINUTE=100

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Environment
NODE_ENV=production

# API Configuration
API_BASE_URL=https://api.com.caramelme.com
NEXTAUTH_URL=https://dashboard.com.caramelme.com
NEXT_PUBLIC_API_URL=https://api.com.caramelme.com

# CORS Configuration
CORS_ORIGIN=https://dashboard.com.caramelme.com
CORS_CREDENTIALS=true

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# OpenTelemetry Configuration
OTEL_EXPORTER_OTLP_ENDPOINT=http://prometheus:4318
OTEL_SERVICE_NAME=dittofeed
OTEL_RESOURCE_ATTRIBUTES=service.name=dittofeed,service.version=1.0.0

# Metrics Collection
ENABLE_METRICS_COLLECTION=true
METRICS_EXPORT_INTERVAL=30000
TENANT_METRICS_ENABLED=true

# =============================================================================
# EMAIL PROVIDER CONFIGURATION
# =============================================================================

# Default Email Provider (Configure based on your provider)
DEFAULT_EMAIL_PROVIDER=smtp

# SMTP Configuration (if using SMTP)
SMTP_HOST=your-smtp-host.com
SMTP_PORT=587
SMTP_USER=your-smtp-username
SMTP_PASSWORD=your-smtp-password
SMTP_SECURE=true

# SendGrid Configuration (if using SendGrid)
SENDGRID_API_KEY=your-sendgrid-api-key

# AWS SES Configuration (if using AWS SES)
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=us-east-1

# =============================================================================
# EXTERNAL INTEGRATIONS
# =============================================================================

# ClickHouse (for analytics)
CLICKHOUSE_HOST=clickhouse.your-domain.com
CLICKHOUSE_PORT=8123
CLICKHOUSE_DATABASE=dittofeed
CLICKHOUSE_USERNAME=default
CLICKHOUSE_PASSWORD=your-clickhouse-password

# Temporal (for workflow orchestration)
TEMPORAL_HOST=temporal.your-domain.com
TEMPORAL_PORT=7233
TEMPORAL_NAMESPACE=dittofeed

# =============================================================================
# FILE STORAGE CONFIGURATION
# =============================================================================

# File Upload Configuration
MAX_FILE_SIZE=10485760  # 10MB
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,text/csv

# S3 Configuration (for file storage)
AWS_S3_BUCKET=your-dittofeed-uploads
AWS_S3_REGION=us-east-1
AWS_S3_ACCESS_KEY_ID=your-s3-access-key
AWS_S3_SECRET_ACCESS_KEY=your-s3-secret-key

# =============================================================================
# WORKER CONFIGURATION
# =============================================================================

# Background Worker Settings
WORKER_CONCURRENCY=10
WORKER_MAX_RETRIES=3
WORKER_RETRY_DELAY=5000
WORKER_TIMEOUT=300000

# Queue Configuration
QUEUE_NAME=dittofeed-jobs
QUEUE_REDIS_URL=${REDIS_URL}

# =============================================================================
# DEVELOPMENT & DEBUGGING (DISABLE IN PRODUCTION)
# =============================================================================

# Debug Settings (SET TO FALSE IN PRODUCTION)
DEBUG=false
VERBOSE_LOGGING=false
ENABLE_PLAYGROUND=false

# Database Query Logging (DISABLE IN PRODUCTION)
LOG_QUERIES=false
LOG_QUERY_PARAMETERS=false

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Feature Toggles
ENABLE_WORKSPACE_ANALYTICS=true
ENABLE_REAL_TIME_NOTIFICATIONS=true
ENABLE_ADVANCED_SEGMENTATION=true
ENABLE_A_B_TESTING=true
ENABLE_JOURNEY_ANALYTICS=true

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================

# Database Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=your-backup-bucket

# =============================================================================
# COMPLIANCE & GDPR
# =============================================================================

# Data Retention Policies
USER_DATA_RETENTION_DAYS=2555  # 7 years
SESSION_DATA_RETENTION_DAYS=30
LOG_DATA_RETENTION_DAYS=90

# GDPR Compliance
ENABLE_GDPR_FEATURES=true
DATA_DELETION_GRACE_PERIOD=30
CONSENT_TRACKING_ENABLED=true

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Connection Pool Optimization
PG_POOL_MIN=5
PG_POOL_MAX=20
PG_POOL_ACQUIRE_TIMEOUT=30000
PG_POOL_CREATE_TIMEOUT=30000
PG_POOL_DESTROY_TIMEOUT=5000
PG_POOL_IDLE_TIMEOUT=600000
PG_POOL_REAP_INTERVAL=1000

# Cache Performance
CACHE_COMPRESSION=true
CACHE_SERIALIZE_JSON=true
ENABLE_QUERY_CACHE=true
QUERY_CACHE_TTL=300

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================

# SSL Settings (for database connections)
DB_SSL_MODE=require
DB_SSL_CERT=/etc/ssl/certs/client-cert.pem
DB_SSL_KEY=/etc/ssl/private/client-key.pem
DB_SSL_CA=/etc/ssl/certs/ca-cert.pem

# =============================================================================
# CLOUDFLARE CONFIGURATION
# =============================================================================

# Cloudflare Tunnel Tokens (Get from Cloudflare Zero Trust Dashboard)
CF_TUNNEL_TOKEN=your-cloudflare-tunnel-token-here
CF_DASHBOARD_TUNNEL_TOKEN=your-dashboard-tunnel-token-here

# Cloudflare Zero Trust Domain
DOMAIN=caramelme.com
SUBDOMAIN=dashboard
PROTOCOL=https

# Trusted Proxies (Cloudflare IP ranges for real client IP detection)
TRUSTED_PROXIES=173.245.48.0/20,103.21.244.0/22,103.22.200.0/22,103.31.4.0/22,141.101.64.0/18,108.162.192.0/18,190.93.240.0/20,188.114.96.0/20,197.234.240.0/22,198.41.128.0/17,162.158.0.0/15,104.16.0.0/13,104.24.0.0/14,172.64.0.0/13,131.0.72.0/22

# =============================================================================
# HEALTH CHECKS & MONITORING
# =============================================================================

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=5000

# Monitoring Endpoints
METRICS_PATH=/metrics
PROMETHEUS_ENABLED=true
GRAFANA_ENABLED=true

# =============================================================================
# EXAMPLE WORKSPACE CONFIGURATION
# =============================================================================

# Default Workspace Settings (for initial setup)
DEFAULT_WORKSPACE_NAME=Production
DEFAULT_WORKSPACE_DOMAIN=your-domain.com
DEFAULT_WORKSPACE_TIMEZONE=UTC
DEFAULT_WORKSPACE_LOCALE=en-US